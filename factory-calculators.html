<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เครื่องมือคำนวณสถิติโรงงาน - Toolbox</title>
    <meta name="description" content="รวมเครื่องมือคำนวณสถิติโรงงานที่สำคัญ เช่น CPK, OEE, EOQ และอื่นๆ ในหน้าเดียว ใช้งานง่ายและรวดเร็ว">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .input {
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border-width: 1px;
            border-color: rgb(209 213 219);
        }
        .button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="p-4">
    <header class="sticky top-0 z-10 backdrop-blur border-b bg-background/70">
        <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
            <a href="index.html" class="flex items-center gap-2 text-xl font-bold">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
                <span class="hidden md:block">กลับ</span>
            </a>
            <div class="flex-1 text-center">
                <h1 class="text-xl font-bold">Factory Calculators Hub</h1>
                <p class="text-sm text-muted-foreground">รวมเครื่องมือคำนวณหลักสำหรับโรงงาน – ในหน้าเดียว</p>
            </div>
            <div class="flex items-center gap-2">
                <button class="button bg-gray-200" onclick="window.print()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-printer"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></svg>
                    พิมพ์เป็น PDF
                </button>
            </div>
        </div>
    </header>
    <main class="max-w-6xl mx-auto p-4 md:p-6 grid gap-6">
        <!-- OEE Calculator -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">OEE – Overall Equipment Effectiveness</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="oee-planned" class="block text-sm font-medium text-gray-700">Planned Production Time</label>
                        <input type="number" id="oee-planned" value="480" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="oee-downtime" class="block text-sm font-medium text-gray-700">Downtime</label>
                        <input type="number" id="oee-downtime" value="60" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="oee-ideal" class="block text-sm font-medium text-gray-700">Ideal Cycle Time</label>
                        <input type="number" id="oee-ideal" value="30" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="oee-total" class="block text-sm font-medium text-gray-700">Total Units</label>
                        <input type="number" id="oee-total" value="800" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="oee-good" class="block text-sm font-medium text-gray-700">Good Units</label>
                        <input type="number" id="oee-good" value="760" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Runtime</span>
                        <span id="oee-runtime" class="font-semibold">0</span>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <div class="card p-3"><div class="text-sm text-gray-500">Availability</div><div id="oee-availability" class="text-2xl font-bold">0%</div></div>
                        <div class="card p-3"><div class="text-sm text-gray-500">Performance</div><div id="oee-performance" class="text-2xl font-bold">0%</div></div>
                        <div class="card p-3"><div class="text-sm text-gray-500">Quality</div><div id="oee-quality" class="text-2xl font-bold">0%</div></div>
                    </div>
                    <div class="rounded-2xl border p-4 bg-gray-100">
                        <div class="text-sm text-gray-500">OEE</div>
                        <div id="oee-result" class="text-4xl font-extrabold">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EOQ Calculator -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">EOQ – Economic Order Quantity</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="eoq-demand" class="block text-sm font-medium text-gray-700">Annual Demand</label>
                        <input type="number" id="eoq-demand" value="12000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="eoq-ordercost" class="block text-sm font-medium text-gray-700">Order Cost</label>
                        <input type="number" id="eoq-ordercost" value="500" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="eoq-holdingcost" class="block text-sm font-medium text-gray-700">Holding Cost per Unit</label>
                        <input type="number" id="eoq-holdingcost" value="20" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">EOQ</span>
                        <span id="eoq-result" class="font-semibold">0</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">EOQ</div>
                        <div id="eoq-value" class="text-4xl font-extrabold">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Takt Time Calculator -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Takt Time</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="takt-time" class="block text-sm font-medium text-gray-700">Available Production Time per Period</label>
                        <input type="number" id="takt-time" value="420" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="takt-demand" class="block text-sm font-medium text-gray-700">Customer Demand per Period</label>
                        <input type="number" id="takt-demand" value="600" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Takt Time</div>
                        <div id="takt-result" class="text-4xl font-extrabold">0 sec/unit</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Capacity Planner -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Capacity Planning</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="capacity-machines" class="block text-sm font-medium text-gray-700">Machines</label>
                        <input type="number" id="capacity-machines" value="3" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="capacity-shifts" class="block text-sm font-medium text-gray-700">Shifts per Day</label>
                        <input type="number" id="capacity-shifts" value="2" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="capacity-hours" class="block text-sm font-medium text-gray-700">Hours per Shift</label>
                        <input type="number" id="capacity-hours" value="8" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="capacity-efficiency" class="block text-sm font-medium text-gray-700">Efficiency</label>
                        <input type="number" id="capacity-efficiency" value="85" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="capacity-cycle" class="block text-sm font-medium text-gray-700">Cycle Time</label>
                        <input type="number" id="capacity-cycle" value="20" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Units per Machine per Day</span>
                        <span id="capacity-units" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Hourly Throughput (all machines)</span>
                        <span id="capacity-hourly" class="font-semibold">0</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Daily Capacity (all machines)</div>
                        <div id="capacity-daily" class="text-4xl font-extrabold">0 units/day</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quality Yield -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Quality – Yield / Scrap / PPM</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="quality-total" class="block text-sm font-medium text-gray-700">Total Units</label>
                        <input type="number" id="quality-total" value="1000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="quality-good" class="block text-sm font-medium text-gray-700">Good Units</label>
                        <input type="number" id="quality-good" value="980" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Scrap Units</span>
                        <span id="quality-scrap" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Yield</span>
                        <span id="quality-yield" class="font-semibold">0%</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Defect Rate</span>
                        <span id="quality-defect" class="font-semibold">0%</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Defects per Million (PPM)</div>
                        <div id="quality-ppm" class="text-4xl font-extrabold">0</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- MTBF/MTTR -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Reliability – MTBF / MTTR / Availability</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="mtbf-hours" class="block text-sm font-medium text-gray-700">MTBF</label>
                        <input type="number" id="mtbf-hours" value="120" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="mttr-hours" class="block text-sm font-medium text-gray-700">MTTR</label>
                        <input type="number" id="mttr-hours" value="2" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Availability</div>
                        <div id="mtbf-availability" class="text-4xl font-extrabold">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Finance ROI -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Financial – ROI & Payback</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="roi-investment" class="block text-sm font-medium text-gray-700">Initial Investment</label>
                        <input type="number" id="roi-investment" value="500000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="roi-benefit" class="block text-sm font-medium text-gray-700">Annual Benefit (savings + profit)</label>
                        <input type="number" id="roi-benefit" value="250000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="roi-cost" class="block text-sm font-medium text-gray-700">Annual Operating Cost</label>
                        <input type="number" id="roi-cost" value="50000" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Net Annual Benefit</span>
                        <span id="roi-net" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">ROI</span>
                        <span id="roi-result" class="font-semibold">0%</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Payback Period</div>
                        <div id="roi-payback" class="text-4xl font-extrabold">0 years</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Break Even -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Break-even Point</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="be-fixed" class="block text-sm font-medium text-gray-700">Fixed Costs</label>
                        <input type="number" id="be-fixed" value="1200000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="be-price" class="block text-sm font-medium text-gray-700">Unit Price</label>
                        <input type="number" id="be-price" value="150" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="be-variable" class="block text-sm font-medium text-gray-700">Variable Cost per Unit</label>
                        <input type="number" id="be-variable" value="85" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Contribution Margin</span>
                        <span id="be-margin" class="font-semibold">0</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Break-even Volume</div>
                        <div id="be-result" class="text-4xl font-extrabold">0 units</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Downtime Cost -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">Downtime Cost</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="dt-rate" class="block text-sm font-medium text-gray-700">Cost per Hour</label>
                        <input type="number" id="dt-rate" value="15000" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="dt-hours" class="block text-sm font-medium text-gray-700">Downtime Hours</label>
                        <input type="number" id="dt-hours" value="3" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Total Downtime Cost</div>
                        <div id="dt-result" class="text-4xl font-extrabold">0 ฿</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SPC Cp/Cpk -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">SPC – Cp / Cpk</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="spc-lsl" class="block text-sm font-medium text-gray-700">Lower Spec Limit (LSL)</label>
                        <input type="number" id="spc-lsl" value="9.5" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="spc-usl" class="block text-sm font-medium text-gray-700">Upper Spec Limit (USL)</label>
                        <input type="number" id="spc-usl" value="10.5" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="spc-mean" class="block text-sm font-medium text-gray-700">Process Mean</label>
                        <input type="number" id="spc-mean" value="10" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="spc-stdev" class="block text-sm font-medium text-gray-700">Standard Deviation (σ)</label>
                        <input type="number" id="spc-stdev" value="0.2" class="w-full input mt-1">
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Cp</span>
                        <span id="spc-cp" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Cpu</span>
                        <span id="spc-cpu" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Cpl</span>
                        <span id="spc-cpl" class="font-semibold">0</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Cpk</div>
                        <div id="spc-cpk" class="text-4xl font-extrabold">0</div>
                        <div id="spc-cpk-status" class="text-base font-medium mt-1"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CPK Calculator -->
        <div class="card p-4">
            <h2 class="text-lg font-bold">CPK Calculator</h2>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="grid gap-4">
                    <div>
                        <label for="cpk-lsl" class="block text-sm font-medium text-gray-700">Lower Spec Limit (LSL)</label>
                        <input type="number" id="cpk-lsl" value="9.5" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="cpk-usl" class="block text-sm font-medium text-gray-700">Upper Spec Limit (USL)</label>
                        <input type="number" id="cpk-usl" value="10.5" class="w-full input mt-1">
                    </div>
                    <div>
                        <label for="cpk-data" class="block text-sm font-medium text-gray-700">Data (comma or newline separated)</label>
                        <textarea id="cpk-data" class="resize-y min-h-[100px] border rounded-md p-2 text-sm">10.1, 10.5, 9.8, 10.3, 10.2, 9.9, 10.0, 10.1, 10.4, 10.2</textarea>
                    </div>
                </div>
                <div class="grid gap-2">
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Data Points</span>
                        <span id="cpk-datapoints" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Mean (X̄)</span>
                        <span id="cpk-mean" class="font-semibold">0</span>
                    </div>
                    <div class="flex justify-between items-baseline py-1">
                        <span class="text-sm text-gray-500">Std Dev (σ)</span>
                        <span id="cpk-stdev" class="font-semibold">0</span>
                    </div>
                    <div class="rounded-2xl border p-6 bg-gray-100">
                        <div class="text-sm text-gray-500">Cpk</div>
                        <div id="cpk-result" class="text-4xl font-extrabold">0</div>
                        <div id="cpk-status" class="text-base font-medium mt-1"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script>
        // OEE Calculator Logic
        function updateOEE() {
            const planned = parseFloat(document.getElementById('oee-planned').value) || 0;
            const downtime = parseFloat(document.getElementById('oee-downtime').value) || 0;
            const ideal = parseFloat(document.getElementById('oee-ideal').value) || 0;
            const total = parseFloat(document.getElementById('oee-total').value) || 0;
            const good = parseFloat(document.getElementById('oee-good').value) || 0;
            const runtime = Math.max(planned - downtime, 0);
            const availability = planned > 0 ? runtime / planned : 0;
            const idealTime = (total * ideal) / 60;
            const performance = runtime > 0 ? idealTime / runtime : 0;
            const quality = total > 0 ? good / total : 0;
            const oee = availability * performance * quality;
            document.getElementById('oee-runtime').textContent = runtime.toFixed(2) + ' min';
            document.getElementById('oee-availability').textContent = (availability * 100).toFixed(1) + '%';
            document.getElementById('oee-performance').textContent = (performance * 100).toFixed(1) + '%';
            document.getElementById('oee-quality').textContent = (quality * 100).toFixed(1) + '%';
            document.getElementById('oee-result').textContent = (oee * 100).toFixed(1) + '%';
        }
        document.getElementById('oee-planned').addEventListener('input', updateOEE);
        document.getElementById('oee-downtime').addEventListener('input', updateOEE);
        document.getElementById('oee-ideal').addEventListener('input', updateOEE);
        document.getElementById('oee-total').addEventListener('input', updateOEE);
        document.getElementById('oee-good').addEventListener('input', updateOEE);
        updateOEE();

        // EOQ Calculator Logic
        function updateEOQ() {
            const demand = parseFloat(document.getElementById('eoq-demand').value) || 0;
            const orderCost = parseFloat(document.getElementById('eoq-ordercost').value) || 0;
            const holdingCost = parseFloat(document.getElementById('eoq-holdingcost').value) || 0;
            const eoq = holdingCost > 0 ? Math.sqrt((2 * demand * orderCost) / holdingCost) : 0;
            document.getElementById('eoq-result').textContent = eoq.toFixed(2) + ' units';
            document.getElementById('eoq-value').textContent = eoq.toFixed(0);
        }
        document.getElementById('eoq-demand').addEventListener('input', updateEOQ);
        document.getElementById('eoq-ordercost').addEventListener('input', updateEOQ);
        document.getElementById('eoq-holdingcost').addEventListener('input', updateEOQ);
        updateEOQ();

        // Takt Time Calculator Logic
        function updateTakt() {
            const availableTimeMin = parseFloat(document.getElementById('takt-time').value) || 0;
            const customerDemand = parseFloat(document.getElementById('takt-demand').value) || 0;
            const takt = customerDemand > 0 ? (availableTimeMin * 60) / customerDemand : 0;
            document.getElementById('takt-result').textContent = takt.toFixed(2) + ' sec/unit';
        }
        document.getElementById('takt-time').addEventListener('input', updateTakt);
        document.getElementById('takt-demand').addEventListener('input', updateTakt);
        updateTakt();

        // Capacity Planner Logic
        function updateCapacity() {
            const machines = parseFloat(document.getElementById('capacity-machines').value) || 0;
            const shifts = parseFloat(document.getElementById('capacity-shifts').value) || 0;
            const hours = parseFloat(document.getElementById('capacity-hours').value) || 0;
            const efficiency = parseFloat(document.getElementById('capacity-efficiency').value) || 0;
            const cycle = parseFloat(document.getElementById('capacity-cycle').value) || 0;
            const eff = Math.max(Math.min(efficiency, 100), 0) / 100;
            const secondsPerDay = shifts * hours * 3600;
            const unitsPerMachinePerDay = cycle > 0 ? (secondsPerDay * eff) / cycle : 0;
            const dailyCapacity = unitsPerMachinePerDay * machines;
            const hourlyRate = cycle > 0 ? (3600 * eff) / cycle * machines : 0;
            document.getElementById('capacity-units').textContent = unitsPerMachinePerDay.toFixed(1);
            document.getElementById('capacity-hourly').textContent = hourlyRate.toFixed(1) + ' units/h';
            document.getElementById('capacity-daily').textContent = dailyCapacity.toFixed(0) + ' units/day';
        }
        document.getElementById('capacity-machines').addEventListener('input', updateCapacity);
        document.getElementById('capacity-shifts').addEventListener('input', updateCapacity);
        document.getElementById('capacity-hours').addEventListener('input', updateCapacity);
        document.getElementById('capacity-efficiency').addEventListener('input', updateCapacity);
        document.getElementById('capacity-cycle').addEventListener('input', updateCapacity);
        updateCapacity();

        // Quality Yield Logic
        function updateQuality() {
            const total = parseFloat(document.getElementById('quality-total').value) || 0;
            const good = parseFloat(document.getElementById('quality-good').value) || 0;
            const scrap = Math.max(total - good, 0);
            const yieldPct = total > 0 ? (good / total) * 100 : 0;
            const defectRatePct = 100 - yieldPct;
            const ppm = total > 0 ? (scrap / total) * 1_000_000 : 0;
            document.getElementById('quality-scrap').textContent = scrap.toFixed(0);
            document.getElementById('quality-yield').textContent = yieldPct.toFixed(2) + '%';
            document.getElementById('quality-defect').textContent = defectRatePct.toFixed(2) + '%';
            document.getElementById('quality-ppm').textContent = ppm.toFixed(0);
        }
        document.getElementById('quality-total').addEventListener('input', updateQuality);
        document.getElementById('quality-good').addEventListener('input', updateQuality);
        updateQuality();
        
        // MTBF/MTTR Logic
        function updateReliability() {
            const mtbfHours = parseFloat(document.getElementById('mtbf-hours').value) || 0;
            const mttrHours = parseFloat(document.getElementById('mttr-hours').value) || 0;
            const denom = mtbfHours + mttrHours;
            const availability = denom > 0 ? mtbfHours / denom : 0;
            document.getElementById('mtbf-availability').textContent = (availability * 100).toFixed(2) + '%';
        }
        document.getElementById('mtbf-hours').addEventListener('input', updateReliability);
        document.getElementById('mttr-hours').addEventListener('input', updateReliability);
        updateReliability();

        // Finance ROI Logic
        function updateFinance() {
            const investment = parseFloat(document.getElementById('roi-investment').value) || 0;
            const annualBenefit = parseFloat(document.getElementById('roi-benefit').value) || 0;
            const annualCost = parseFloat(document.getElementById('roi-cost').value) || 0;
            const net = annualBenefit - annualCost;
            const roi = investment > 0 ? (net / investment) * 100 : 0;
            const paybackYears = net > 0 ? investment / net : Infinity;
            document.getElementById('roi-net').textContent = net.toLocaleString() + ' ฿/yr';
            document.getElementById('roi-result').textContent = roi.toFixed(2) + '%';
            document.getElementById('roi-payback').textContent = Number.isFinite(paybackYears) ? paybackYears.toFixed(2) + ' years' : '—';
        }
        document.getElementById('roi-investment').addEventListener('input', updateFinance);
        document.getElementById('roi-benefit').addEventListener('input', updateFinance);
        document.getElementById('roi-cost').addEventListener('input', updateFinance);
        updateFinance();

        // Break Even Logic
        function updateBreakEven() {
            const fixed = parseFloat(document.getElementById('be-fixed').value) || 0;
            const price = parseFloat(document.getElementById('be-price').value) || 0;
            const variable = parseFloat(document.getElementById('be-variable').value) || 0;
            const cm = price - variable;
            const units = cm > 0 ? fixed / cm : Infinity;
            document.getElementById('be-margin').textContent = cm.toFixed(2) + ' ฿/unit';
            document.getElementById('be-result').textContent = Number.isFinite(units) ? Math.ceil(units).toLocaleString() + ' units' : '—';
        }
        document.getElementById('be-fixed').addEventListener('input', updateBreakEven);
        document.getElementById('be-price').addEventListener('input', updateBreakEven);
        document.getElementById('be-variable').addEventListener('input', updateBreakEven);
        updateBreakEven();

        // Downtime Cost Logic
        function updateDowntimeCost() {
            const rate = parseFloat(document.getElementById('dt-rate').value) || 0;
            const hours = parseFloat(document.getElementById('dt-hours').value) || 0;
            const cost = rate * hours;
            document.getElementById('dt-result').textContent = cost.toLocaleString() + ' ฿';
        }
        document.getElementById('dt-rate').addEventListener('input', updateDowntimeCost);
        document.getElementById('dt-hours').addEventListener('input', updateDowntimeCost);
        updateDowntimeCost();

        // SPC Cp/Cpk Logic
        function updateSPC() {
            const lsl = parseFloat(document.getElementById('spc-lsl').value) || 0;
            const usl = parseFloat(document.getElementById('spc-usl').value) || 0;
            const mean = parseFloat(document.getElementById('spc-mean').value) || 0;
            const stdev = parseFloat(document.getElementById('spc-stdev').value) || 0;
            const cp = stdev > 0 ? (usl - lsl) / (6 * stdev) : 0;
            const cpu = stdev > 0 ? (usl - mean) / (3 * stdev) : 0;
            const cpl = stdev > 0 ? (mean - lsl) / (3 * stdev) : 0;
            const cpk = Math.min(cpu, cpl);
            document.getElementById('spc-cp').textContent = cp.toFixed(3);
            document.getElementById('spc-cpu').textContent = cpu.toFixed(3);
            document.getElementById('spc-cpl').textContent = cpl.toFixed(3);
            document.getElementById('spc-cpk').textContent = cpk.toFixed(3);

            let statusText = '';
            let statusColor = '';
            if (cpk >= 2.00) {
                statusText = "ระดับโลก (World Class)";
                statusColor = "text-blue-600";
            } else if (cpk >= 1.67) {
                statusText = "มีความสามารถสูงมาก (Highly Capable)";
                statusColor = "text-indigo-600";
            } else if (cpk >= 1.33) {
                statusText = "มีความสามารถสูง (Capable)";
                statusColor = "text-green-600";
            } else if (cpk >= 1.00) {
                statusText = "รองรับได้ (Adequate)";
                statusColor = "text-yellow-600";
            } else {
                statusText = "ไม่สามารถรองรับได้ (Not Capable)";
                statusColor = "text-red-600";
            }
            // Fix: Added `id` attributes to the HTML elements
            document.getElementById('spc-cpk').className = `text-4xl font-extrabold ${statusColor}`;
            document.getElementById('spc-cpk-status').textContent = statusText;
            document.getElementById('spc-cpk-status').className = `text-base font-medium mt-1 ${statusColor}`;
        }
        document.getElementById('spc-lsl').addEventListener('input', updateSPC);
        document.getElementById('spc-usl').addEventListener('input', updateSPC);
        document.getElementById('spc-mean').addEventListener('input', updateSPC);
        document.getElementById('spc-stdev').addEventListener('input', updateSPC);
        updateSPC();
        
        // CPK Calculator Logic
        function updateCPK() {
            const lsl = parseFloat(document.getElementById('cpk-lsl').value) || 0;
            const usl = parseFloat(document.getElementById('cpk-usl').value) || 0;
            const dataText = document.getElementById('cpk-data').value;
            const data = dataText.split(/[\s,]+/).filter(Boolean).map(Number);
            
            if (data.length < 2) return;
            
            const mean = data.reduce((sum, val) => sum + val, 0) / data.length;
            const stdev = Math.sqrt(data.reduce((sum, val) => sum + (val - mean) ** 2, 0) / (data.length - 1));
            const cpu = stdev > 0 ? (usl - mean) / (3 * stdev) : 0;
            const cpl = stdev > 0 ? (mean - lsl) / (3 * stdev) : 0;
            const cpk = Math.min(cpu, cpl);
            
            document.getElementById('cpk-datapoints').textContent = data.length;
            document.getElementById('cpk-mean').textContent = mean.toFixed(3);
            document.getElementById('cpk-stdev').textContent = stdev.toFixed(3);
            document.getElementById('cpk-result').textContent = cpk.toFixed(3);

            let statusText = '';
            let statusColor = '';
            if (cpk >= 2.00) {
                statusText = "อยู่ในระดับโลก (World Class)";
                statusColor = "text-blue-600";
            } else if (cpk >= 1.67) {
                statusText = "มีความสามารถสูงมาก (Highly Capable)";
                statusColor = "text-indigo-600";
            } else if (cpk >= 1.33) {
                statusText = "มีความสามารถสูง (Capable)";
                statusColor = "text-green-600";
            } else if (cpk >= 1.00) {
                statusText = "รองรับได้ (Adequate)";
                statusColor = "text-yellow-600";
            } else {
                statusText = "ไม่สามารถรองรับได้ (Not Capable)";
                statusColor = "text-red-600";
            }
            document.getElementById('cpk-result').className = `text-4xl font-extrabold ${statusColor}`;
            document.getElementById('cpk-status').textContent = statusText;
            document.getElementById('cpk-status').className = `text-base font-medium mt-1 ${statusColor}`;
        }
        document.getElementById('cpk-lsl').addEventListener('input', updateCPK);
        document.getElementById('cpk-usl').addEventListener('input', updateCPK);
        document.getElementById('cpk-data').addEventListener('input', updateCPK);
        updateCPK();
    </script>
</body>
</html>
